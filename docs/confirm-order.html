<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Confirm Order – MomentumXLab</title>
  <link rel="stylesheet" href="style.css"/>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
</head>
<body>
  <h1>Confirm Your Order</h1>
  <div id="order-summary"></div>
  <button id="btn-pay">Proceed to Payment</button>

  <script>
    // 1) Init Firebase
    firebase.initializeApp({
      apiKey: "AIzaSyDeUaFNrqo5DKQWuWz1kiru1MVOSuRHDmk",
      authDomain: "momentumxlab-37ce2.firebaseapp.com",
      projectId: "momentumxlab-37ce2",
      appId: "1:1234567890:web:abcdef123456"
    });
    const auth = firebase.auth();

    // 2) ดึง plan จาก URL
    const pkgMap = {
      monthly: { name: 'Pro-4 Monthly', price: 19.99 },
      '6m':     { name: 'Pro-4 6-Month', price: 106.99 },
      annual:  { name: 'Pro-4 Annual', price: 193.99 }
    };
    const params = new URLSearchParams(location.search);
    const plan   = params.get('plan');
    const pkg    = pkgMap[plan] || {};

    // 3) แสดงสรุปออเดอร์
    document.getElementById('order-summary').innerHTML = `
      <p>Product: ${pkg.name}</p>
      <p>Price: $${pkg.price}</p>
    `;

    // 4) ปุ่มจ่าย (เชื่อมต่อ Stripe Webhook / Cloud Function ตามจริง)
    document.getElementById('btn-pay').addEventListener('click', () => {
      if (!auth.currentUser) {
        alert('Session expired, please login again.');
        location.href = 'login.html?redirect=' + encodeURIComponent(location.href);
        return;
      }
      // TODO: call Firebase Function to create Checkout session
      alert(`Proceed to Stripe for ${pkg.name}`);
    });
  </script>
</body>
</html>
