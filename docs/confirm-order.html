<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Confirm Your Order – MomentumXLab</title>
  <link rel="icon" href="favicon.ico"/>
  <link
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <!-- Confirm Section with Layout Style -->
  <section class="pro4-section">
    <div class="left-content">
  <h2>Confirm Your Order</h2>

  <ul class="feature-list" id="license-summary">
    <!-- summary injected by JS -->
  </ul>

  <form id="order-form" class="order-form">
    <div class="form-group">
      <label for="email">Email (readonly)</label>
      <input type="email" id="email" name="email" readonly required/>
    </div>

    <div class="form-group">
      <label for="fullName">Full Name</label>
      <input type="text" id="fullName" name="fullName" required/>
    </div>

    <div class="form-group">
      <label for="phone">Phone Number</label>
      <input type="tel" id="phone" name="phone" required/>
    </div>

    <div class="form-group">
      <label for="mt5Account">MT5 Account Number</label>
      <input type="text" id="mt5Account" name="mt5Account" pattern="\d+" required/>
    </div>

    <div class="form-group">
      <label for="brokerServer">Broker Server</label>
      <select id="brokerServer" name="brokerServer" required>
        <option value="">-- Select Server --</option>
        <option value="Exness-Real1">Exness-Real1</option>
        <option value="Exness-Real2">Exness-Real2</option>
        <option value="XM-MT5Live">XM-MT5Live</option>
        <option value="FBS-Real">FBS-Real</option>
        <option value="ICMarkets-Live">ICMarkets-Live</option>
      </select>
    </div>

    <p class="note">License will be bound to this MT5 account and server only.</p>

    <div class="form-group checkbox-group">
      <input type="checkbox" id="agree"/>
      <label for="agree">
        I acknowledge the terms and certify that the above information is accurate.
      </label>
    </div>

    <button class="cta-btn" type="submit" id="btn-confirm" disabled>
      Confirm and Generate License
    </button>
    <p id="status" class="status-text"></p>
  </form>
</div>

  <footer class="footer-section">
    <div class="footer-logo-left">
      <img src="momentumxlab-logo.png" alt="MomentumXLab Logo"/>
    </div>
    <div class="footer-text">
      <p>
        By submitting this form, you acknowledge the terms and certify accuracy of the information.
      </p>
      <p class="copyright">&copy; 2025 MomentumXLab. All rights reserved.</p>
    </div>
  </footer>

  <!-- SDKs -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyDeUaFNrqo5DKQWuWz1kiru1MVOSuRHDmk",
      authDomain: "momentumxlab-37ce2.firebaseapp.com",
      projectId: "momentumxlab-37ce2",
      storageBucket: "momentumxlab-37ce2.appspot.com",
      messagingSenderId: "694369524772",
      appId: "1:694369524772:web:60961d9548591c1ff3ccb1"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // Plan info from URL
    const urlParams = new URLSearchParams(location.search);
    const planKey = urlParams.get("plan") || "monthly";

    const plans = {
      monthly: { name: "Pro-4 Monthly",  price: 19.99,  months: 1 },
      "6m":    { name: "Pro-4 6-Month",  price: 106.99, months: 6 },
      annual:  { name: "Pro-4 Annual",   price: 193.99, months: 12 }
    };
    const plan = plans[planKey];

    // License start & end
    const startDate = new Date();
    const endDate = new Date(startDate);
    endDate.setMonth(endDate.getMonth() + plan.months);

    const formatDate = d => d.toISOString().split("T")[0];

    document.getElementById("license-summary").innerHTML = `
      <li><strong>Plan:</strong> ${plan.name}</li>
      <li><strong>Price:</strong> $${plan.price.toFixed(2)}</li>
      <li><strong>License Period:</strong> ${formatDate(startDate)} → ${formatDate(endDate)}</li>
    `;

    // Show current user's email
    const emailInput = document.getElementById("email");
    auth.onAuthStateChanged(user => {
      if (user) emailInput.value = user.email;
    });

    // Enable confirm button when checkbox ticked
    const agreeCb = document.getElementById("agree");
    const btnConfirm = document.getElementById("btn-confirm");
    agreeCb.addEventListener("change", () => {
      btnConfirm.disabled = !agreeCb.checked;
    });

    // Handle form submit
    document.getElementById("order-form").addEventListener("submit", async e => {
      e.preventDefault();
      const user = auth.currentUser;
      if (!user) {
        await Swal.fire("Session Expired", "Please login again to proceed.", "warning");
        const back = encodeURIComponent(location.href);
        return window.location.href = `login.html?redirect=${back}`;
      }

      const data = {
        email: user.email,
        fullName: e.target.fullName.value.trim(),
        phone: e.target.phone.value.trim(),
        mt5Account: e.target.mt5Account.value.trim(),
        brokerServer: e.target.brokerServer.value,
        plan: planKey,
        licenseStart: formatDate(startDate),
        licenseEnd: formatDate(endDate)
      };

      console.log("→ License data:", data);
      await Swal.fire("Confirmed", "Your license request is being processed", "success");
    });
  </script>
</body>
</html>
