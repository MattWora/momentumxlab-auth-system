<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Confirm Order – MomentumXLab</title>
  <link rel="icon" href="favicon.ico"/>
  <link
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="style.css"/>

  <!-- Firebase & SweetAlert2 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
  <h1>Confirm Your Order</h1>
  <div id="summary">Loading…</div>
  <button id="btn-pay">Proceed to Payment</button>

  <script>
    // 1) Firebase init
    const firebaseConfig = {
      apiKey:      "AIzaSyDeUaFNrqo5DKQWuWz1kiru1MVOSuRHDmk",
      authDomain:  "momentumxlab-37ce2.firebaseapp.com",
      projectId:   "momentumxlab-37ce2",
      storageBucket: "momentumxlab-37ce2.appspot.com",
      messagingSenderId: "694369524772",
      appId:       "1:694369524772:web:60961d9548591c1ff3ccb1"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // 2) ดึง plan จาก URL
    const packages = {
      monthly: { name: 'Pro-4 Monthly', price: 19.99 },
      '6m':     { name: 'Pro-4 6-Month', price: 106.99 },
      annual:  { name: 'Pro-4 Annual', price: 193.99 }
    };
    const params = new URLSearchParams(location.search);
    const planKey = params.get('plan') || 'monthly';
    const pkg     = packages[planKey];

    // 3) แสดงสรุปออเดอร์
    document.getElementById('summary').innerHTML = `
      <p>Product: ${pkg.name}</p>
      <p>Price: $${pkg.price.toFixed(2)}</p>
    `;

    // 4) ปุ่มจ่ายเงิน
    document.getElementById('btn-pay').addEventListener('click', async () => {
      if (!auth.currentUser) {
        await Swal.fire('Error','Session expired, please login again.','error');
        location.href = 
          'login.html?redirect=' + encodeURIComponent(location.href);
        return;
      }
      // TODO: เรียก Stripe / Cloud Function เพื่อสร้าง Checkout Session
      await Swal.fire('Proceeding','Redirecting to payment gateway','info');
    });
  </script>
</body>
</html>
