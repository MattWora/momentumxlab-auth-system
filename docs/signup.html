<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Signup – MomentumXLab</title>
  <style>
    body {
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(to bottom, #1f1f1f, #3c3c3c);
      color: #f2f2f2;
      text-align: center;
      padding-top: 50px;
    }
    input, button {
      padding: 12px;
      margin: 8px;
      border: none;
      border-radius: 4px;
      font-size: 16px;
    }
    button {
      background-color: #0af;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #08d;
    }
  </style>
</head>
<body>
  <h1>สมัครสมาชิก MomentumXLab</h1>
  <input type="email" id="email" placeholder="Email"><br>
  <input type="password" id="password" placeholder="Password"><br>
  <button onclick="signup()">สมัครสมาชิก</button>
  <p id="status"></p>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js"></script>

  <script>
    // ✅ เชื่อม Firebase SDK อย่างถูกต้อง
    const firebaseConfig = {
      apiKey: "AIzaSyDeUaFNrqO5DKQWuw21kIru1MVOSuRHDmk",
      authDomain: "momentumxlab-37ce2.firebaseapp.com",
      projectId: "momentumxlab-37ce2"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // ✅ วางฟังก์ชัน signup หลังประกาศตัวแปร auth/db
    function signup() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const status = document.getElementById("status");

      auth.createUserWithEmailAndPassword(email, password)
        .then((userCred) => {
          const uid = userCred.user.uid;
          return db.collection("users").doc(uid).set({
            activated: true,
            plan: "Free",
            paidDate: new Date().toISOString(),
            expires: "" // จะใส่ logic หมดอายุภายหลัง
          });
        })
        .then(() => {
          status.textContent = "สมัครสำเร็จ! ✅";
          status.style.color = "lightgreen";
        })
        .catch((err) => {
          status.textContent = "เกิดข้อผิดพลาด: " + err.message;
          status.style.color = "orange";
        });
    }
  </script>
</body>
</html>
